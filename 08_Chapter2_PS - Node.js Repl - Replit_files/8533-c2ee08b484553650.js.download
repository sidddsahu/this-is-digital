"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8533],{60368:function(e,n,r){var t=r(35944),a=r(60536),i=r.n(a);r(67294);n.Z=function(e){var n=e.maxLength,r=void 0===n?140:n,a=e.value,l=void 0===a?"":a,o=e.hideLabel,u=void 0!==o&&o;return(0,t.BX)("div",{className:"jsx-59d2089b8a0ab881",children:[l.length," / ",r," ",u?"":"characters",(0,t.tZ)(i(),{id:"59d2089b8a0ab881",children:"div.jsx-59d2089b8a0ab881{color:var(--foreground-dimmer);font-size:.75em;text-align:right;margin-top:var(--space-8)}"})]})}},80658:function(e,n,r){r.d(n,{Z:function(){return S}});var t=r(26042),a=r(69396),i=r(10253),l=r(35944),o=r(67294),u=r(92876),s=r(30992),c=r(65975),d=r(98967),p=r(83074),v=r(58086),f=r(37424),h=r(60368),m=r(14455),g=r(9836),Z=r(30168),R=r(94412),k=r(7297),b=r(31230),w=r(97212),x=r(46829);function y(){var e=(0,k.Z)(["\n  query ForkModal {\n    currentUser {\n      id\n      url\n      image\n      username\n      ...ReplOwnerCurrentUser\n      teams {\n        id\n        ...ReplOwnerTeam\n      }\n    }\n  }\n  ","\n  ","\n"]);return y=function(){return e},e}var _={},C=(0,b.ZP)(y(),w.s,w.a);var E=r(99383),I=function(e){var n=e.onFork,r=e.hideModal,t=e.initialTitle,a=e.initialDescription,u=void 0===a?"":a,d=e.initialPrivacy,k=e.teamContext,b=e.currentUser,w=o.useRef(null),x=(0,f.H)(),y=(0,i.Z)((0,g.Y)(b,k),2),_=y[0],C=y[1],I=(0,i.Z)((0,E.c)(_,b,d||!1),3),S=I[0],B=I[1],P=I[2],U=(0,s.Y)(t,(function(e){if(e)return e.length>60?{message:"Must be no longer than 60 characters"}:/[0-9a-zA-Z]/.test(e)?void 0:{message:"Title must contain at least one alphanumeric character"}})),G=(0,s.Y)(u,(function(e){if(e&&e.length>v.p)return{message:"Must be no longer than ".concat(v.p," characters")}}));o.useEffect((function(){w.current&&w.current.focus()}),[w]);var T="Team"===_.__typename?_.id:null;return(0,l.tZ)("form",{onSubmit:function(e){e.preventDefault(),U.validate()||G.validate()||(n(T,U.value,G.value,S),r())},children:(0,l.BX)(c.G7,{css:[c.l0.colWithGap(16)],children:[(0,l.tZ)(c.h4,{variant:"headerDefault",level:2,children:"Fork Repl"}),(0,l.BX)(c.G7,{css:[c.l0.colWithGap(16)],children:[(0,l.BX)(c.G7,{css:[c.l0.colWithGap(4)],children:[(0,l.BX)(c.G7,{css:[c.l0.flex.row,c.l0.justify.spaceBetween,c.l0.align.end],children:[(0,l.tZ)(m._,{for:x("name"),children:"Name"}),(0,l.tZ)(h.Z,{maxLength:60,value:U.value,hideLabel:!0})]}),(0,l.tZ)(c.II,{ref:w,className:"repl-title-input",placeholder:"Name your Repl",onChange:function(e){return U.setValue(e.target.value)},onFocus:function(e){return e.target.select()},value:U.value,onBlur:U.handleBlur,id:x("name")}),U.error&&(0,l.tZ)(c.xv,{css:[c.l0.color.accentNegativeStronger],children:U.error.message})]}),(0,l.BX)(c.G7,{css:[c.l0.colWithGap(4)],children:[(0,l.BX)(c.G7,{css:[c.l0.flex.row,c.l0.justify.spaceBetween,c.l0.align.end],children:[(0,l.tZ)(m._,{for:x("description"),children:"Description"}),(0,l.tZ)(h.Z,{maxLength:v.p,value:G.value,hideLabel:!0})]}),(0,l.tZ)(c.B,{maxLength:v.p,value:G.value,onChange:function(e){return G.setValue(e.target.value)},placeholder:"What does this Repl do?",css:[c.l0.minHeight(96),c.l0.maxHeight(128),{resize:"vertical"}],id:x("description")})]}),(0,l.tZ)(R.P,{context:"fork_modal",isPrivate:S,setIsPrivate:B,privacyState:P})]}),b.teams.length>0?(0,l.BX)(c.G7,{css:[c.l0.colWithGap(8)],children:[(0,l.tZ)(m._,{for:x("owner"),children:"Owner"}),(0,l.tZ)(Z.Z,{id:x("owner"),currentUser:b,initialSelectedUsername:_.username,onChange:function(e){return C(e.username)}})]}):null,(0,l.BX)(c.G7,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:[(0,l.tZ)(c.zx,{onClick:r,text:"Cancel",type:"button"}),(0,l.tZ)(c.zx,{colorway:"primary",type:"submit",disabled:Boolean(U.error||G.error),text:"Fork Repl",iconLeft:(0,l.tZ)(p.Z,{})})]})]})})};function S(e){var n=function(e){var n=(0,t.Z)({},_,e);return x.useQuery(C,n)}({fetchPolicy:"cache-and-network",onError:function(e){u.$e((function(n){n.setTag("fork-modal",!0),u.Tb(e)}))}}),r=n.data,i=n.loading,o=n.error;if(i)return(0,l.tZ)(c.xv,{color:"dimmer",children:"Loading..."});if(o)return(0,l.tZ)(c.xv,{children:"Something went wrong."});if(!r)return null;var s=r.currentUser;return s?(0,l.tZ)(I,(0,a.Z)((0,t.Z)({},e),{currentUser:s})):(0,l.tZ)(d.Z,{title:"Sign up or log in to fork this Repl",onSuccess:function(){},source:"fork"})}},59292:function(e,n,r){r.d(n,{Z:function(){return R}});var t=r(26042),a=r(69396),i=r(10253),l=r(67294),o=r(11163),u=r(93058),s=r(7297),c=r(31230),d=r(46829);function p(){var e=(0,s.Z)(["\n  mutation ForkReplCreateRepl($input: CreateReplInput!) {\n    createRepl(input: $input) {\n      ... on Repl {\n        id\n        url\n        isPrivate\n        language\n        origin {\n          id\n          isOwner\n        }\n        source {\n          release {\n            id\n            repl {\n              id\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return p=function(){return e},e}var v={},f=(0,c.ZP)(p());function h(e){var n=(0,t.Z)({},v,e);return d.useMutation(f,n)}var m=r(33400),g=r(86292),Z=r(15935);function R(){var e,n,r,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=s.onFork,d=s.onError,p=(0,o.useRouter)(),v=(0,u.Z)().showError,f=(0,m.Z)(),R=(0,i.Z)(h({onCompleted:function(e){var n="Repl"===(null===e||void 0===e?void 0:e.createRepl.__typename)?e.createRepl:null;if(n)if(c&&c(e),"/replEnvironment2"!==p.pathname&&"/replEnvironmentMobile"!==p.pathname)p.push({pathname:f,query:{replUrl:n.url}},{pathname:n.url});else{var r=n.url+(p.query.lite?"?lite=".concat(p.query.lite.toString()):"");window.location.href=r}}}),2),k=R[0],b=R[1],w="UserError"===(null===(e=b.data)||void 0===e?void 0:e.createRepl.__typename)?null===(n=b.data)||void 0===n?void 0:n.createRepl.message:null===(r=b.error)||void 0===r?void 0:r.message;l.useEffect((function(){w&&(v(w),d&&d())}),[w,v,d]);var x=l.useCallback((function(e){var n=e.originId,r=e.replReleaseId,i=e.teamId,l=e.title,o=e.description,u=e.isPrivate,s=e.trackingData,c=e.forkToPersonal;k({variables:{input:{originId:n,replReleaseId:r,teamId:i,title:l,isPrivate:u,description:o,forkToPersonal:c,gitRemoteUrl:""}}}).then((function(e){var n,i,l,o,u,c,d,p="Repl"===(null===(n=e.data)||void 0===n?void 0:n.createRepl.__typename)?e.data.createRepl:null;p&&(0,g.j)(g.U3.REPL_CREATED,(0,a.Z)((0,t.Z)({isSignup:!1,isOnboarding:!1},s),{isForked:!0,isPrivate:p.isPrivate,replId:p.id,isRenamed:!1,language:p.language,isSelfForked:!!(null===(i=p.origin)||void 0===i?void 0:i.isOwner),isTemplateFork:Boolean(r),templateReplId:(null===(l=p.source)||void 0===l||null===(o=l.release)||void 0===o||null===(u=o.repl)||void 0===u?void 0:u.id)||void 0,templateType:(null===(c=p.source)||void 0===c||null===(d=c.release)||void 0===d?void 0:d.repl)?(0,Z.lw)(p.source.release.repl):void 0}))}))}),[k]),y=!!(b.loading||b.data&&"Repl"===b.data.createRepl.__typename);return[x,{loading:y}]}},70338:function(e,n,r){var t=r(47568),a=r(34051),i=r.n(a),l=r(15794);n.Z=function(){var e=(0,t.Z)(i().mark((function e(n,r){var t,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}t=n.user,e.next=14;break;case 5:if(!((a=r.getState().user)&&a.userInfo.isLoggedIn&&a.userInfo)){e.next=10;break}t=a.userInfo,e.next=14;break;case 10:return e.next=12,(0,l.LK)("/is_authenticated");case 12:(o=e.sent).success&&(t=o.user);case 14:return t&&(n&&(t=JSON.parse(JSON.stringify(t))),r.dispatch({type:"FETCH_USER_INFO_SUCCESS",user:t})),e.abrupt("return",{user:t});case 16:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()},58086:function(e,n,r){r.d(n,{p:function(){return t}});var t=1e3}}]);
//# sourceMappingURL=8533-c2ee08b484553650.js.map